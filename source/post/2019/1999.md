---
author: owent
categories:
  - Article
  - Blablabla
date: 2019-12-12 22:49:50
draft: true
id: 1999
tags: 
  - kvs
  - database
  - distribute
  - 分布式系统
  - 分布式存储系统
  - anna
title: Anna（支持任意扩展和超高性能的KV数据库系统）阅读笔记
type: post
---

前言
================================================
前段时间被同事安利了这个分布式最终一致性的存储系统 [Anna][^anna] 。初略看了一眼Paper，似乎很是牛X。说是支持任意规模的扩展，并且性能不低于 [pedis][2]。于是想来看看了解下这套系统的设计特点和这种夸张的单机性能和扩张性的来源。

主流分布式KVS的比较
================================================

| 系统名词      | 扩容设计    | 内存模型          | 针对单个Key的一致性策略 | 针对多个Key一致性策略 |
|---------------|-------------|-------------------|-------------------------|-----------------------|
| Masstree      | 多核        | 共享内存          | 线性                    | 无                    |
| Bw-tree       | 多核        | 共享内存          | 线性                    | 无                    |
| PALM          | 多核        | 共享内存          | 线性                    | 无                    |
| MICA          | 多核        | 共享内存          | 线性                    | 无                    |
| Redis         | 单核        | N/A               | 线性                    | 串行化                |
| COPS, Bolt-on | 分布式      | 消息队列          | Causal | Causal |
| Bayou         | 分布式      | 消息队列          | 最终一致性, 单调读/写, Read Your Writes | 最终一致性 |
| Dynamo        | 分布式      | 消息队列          | 线性, 最终一致性 | 无 |
| Cassandra     | 分布式      | 消息队列          | 线性, 最终一致性 | 无 |
| PNUTS         | 分布式      | 消息队列          | 线性写, 单调读 | 无 |
| CouchDB       | 分布式      | 消息队列          | 最终一致性 | 无 |
| Voldemort     | 分布式      | 消息队列          | 线性, 最终一致性 | 无 |
| HBase         | 分布式      | 消息队列          | 线性 | 无 |
| Riak          | 分布式      | 消息队列          | 最终一致性 | 无 |
| DocumentDB    | 分布式      | 消息队列          | 最终一致性, Session, Bounded Staleness, Linearizability | 无 |
| Memcached     | 多核&分布式 | 共享内存&消息队列 | 线性 | 无 |
| MongoDB       | 多核&分布式 | 共享内存&消息队列 | 线性 | 无 |
| H-Store       | 多核&分布式 | 消息队列          | 线性 | 串行化 |
| ScyllaDB      | 多核&分布式 | 消息队列          | 线性, 最终一致性 | 无 |
| Anna          | 多核&分布式 | 消息队列          | 最终一致性, Causal, Item Cut, Writes Follow Reads, Monotonic Reads/Writes, Read Your Writes, PRAM | Read Committed, Read Uncommitted |

> 一致性说明: **线性** 是指在更新了某行之后，后续的客户端不会读到老数据，通常用在单行一致性上； **最终一致性** 是指在更新了某行之后，后续的客户端可能在某些（缓存）结点上会读到老数据（特别是并发执行的事务），但是最后（一段时间后）一定会读到一致的最新数据； **串行化** 是指对多个读写同一行数据的事务，采用排序和排队执行的机制，这样也能保证数据的严格一致性； **单调读** 是指在某一个客户端读取到新数据后，不会再读到老数据，但是有可能在更新一行后短期内客户端仍然读到老数据； **单调写** 是指对单个客户端的写入操作一定是有序的；


[^anna]: http://db.cs.berkeley.edu/jmh/papers/anna_ieee18.pdf "Anna: A KVS For Any Scale"
[^redis]: https://redis.io "Redis"
[^raft]: https://raft.github.io/ "The Raft Consensus Algorithm"

[1]: https://redis.io/
[2]: https://github.com/fastio/pedis
[3]: http://db.cs.berkeley.edu/jmh/papers/anna_ieee18.pdf
